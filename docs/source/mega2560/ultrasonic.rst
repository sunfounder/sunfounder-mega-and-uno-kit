.. note::

    ä½ å¥½ï¼Œæ¬¢è¿æ¥åˆ° SunFounder æ ‘è“æ´¾ã€Arduino å’Œ ESP32 çˆ±å¥½è€…ç¤¾åŒºçš„ Facebook é¡µé¢ï¼ä¸å…¶ä»–çˆ±å¥½è€…ä¸€èµ·æ·±å…¥æ¢è®¨æ ‘è“æ´¾ã€Arduino å’Œ ESP32ã€‚

    **ä¸ºä»€ä¹ˆåŠ å…¥ï¼Ÿ**

    - **ä¸“å®¶æ”¯æŒ**: é€šè¿‡æˆ‘ä»¬çš„ç¤¾åŒºå’Œå›¢é˜Ÿçš„å¸®åŠ©è§£å†³å”®åé—®é¢˜å’ŒæŠ€æœ¯æŒ‘æˆ˜ã€‚
    - **å­¦ä¹ ä¸åˆ†äº«**: äº¤æµæŠ€å·§å’Œæ•™ç¨‹ï¼Œæå‡ä½ çš„æŠ€èƒ½ã€‚
    - **ç‹¬å®¶é¢„è§ˆ**: æå‰äº†è§£æ–°äº§å“å‘å¸ƒå’Œé¢„å‘Šã€‚
    - **ç‰¹åˆ«æŠ˜æ‰£**: å°Šäº«æˆ‘ä»¬æœ€æ–°äº§å“çš„ä¸“å±æŠ˜æ‰£ã€‚
    - **èŠ‚æ—¥ä¿ƒé”€å’Œèµ å“**: å‚ä¸èµ å“æ´»åŠ¨å’ŒèŠ‚æ—¥ä¿ƒé”€ã€‚

    ğŸ‘‰ å‡†å¤‡å¥½ä¸æˆ‘ä»¬ä¸€èµ·æ¢ç´¢å’Œåˆ›é€ äº†å—ï¼Ÿç‚¹å‡» [|link_sf_facebook|] åŠ å…¥æˆ‘ä»¬å§ï¼

.. _ultrasonic_mega:

ç¬¬ 13 è¯¾ è¶…å£°æ³¢
=====================

ä»‹ç»
----------------

å€’è½¦æ—¶ï¼Œä½ ä¼šçœ‹åˆ°æ±½è½¦ä¸å‘¨å›´éšœç¢ç‰©ä¹‹é—´çš„è·ç¦»ï¼Œä»¥é¿å…ç¢°æ’ã€‚æ£€æµ‹è·ç¦»çš„è£…ç½®æ˜¯è¶…å£°æ³¢ä¼ æ„Ÿå™¨ã€‚åœ¨æœ¬å®éªŒä¸­ï¼Œä½ å°†äº†è§£è¶…å£°æ³¢å¦‚ä½•æ£€æµ‹è·ç¦»ã€‚

æ‰€éœ€å™¨ä»¶
-------------

.. image:: media_mega2560/megac13.png
    :align: center

* :ref:`SunFounder Megaæ¿`
* :ref:`é¢åŒ…æ¿`
* :ref:`è·³çº¿`
* :ref:`ç”µä½å™¨`
* :ref:`è¶…å£°æ³¢æ¨¡å—`
* :ref:`LCD1602æ¶²æ™¶æ˜¾ç¤ºå±`

åŸç†å›¾
--------------------------

åŸç†å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š

.. image:: media_mega2560/image181.png
    :align: center


å®éªŒæ­¥éª¤
--------------------------

**ç¬¬ 1 æ­¥**ï¼šæ­å»ºç”µè·¯ã€‚

.. image:: media_mega2560/image182.png
    :align: center

**ç¬¬ 2 æ­¥**ï¼šæ‰“å¼€ä»£ç æ–‡ä»¶ ``Lesson_13_Ultrasonic.ino``ã€‚

**ç¬¬ 3 æ­¥**ï¼šé€‰æ‹© **å¼€å‘æ¿** å’Œ **ç«¯å£**ã€‚

**ç¬¬ 4 æ­¥**ï¼šç‚¹å‡» **ä¸Šä¼ ** æŒ‰é’®æ¥ä¸Šä¼ ä»£ç ã€‚

.. note::

    å¦‚æœå‡ºç°å¦‚ä¸‹é”™è¯¯ï¼Œæ˜¯å› ä¸ºä½ æ²¡æœ‰æ·»åŠ åä¸ºNewPingçš„åº“ï¼Œè¯·å‚è€ƒ :ref:`æ·»åŠ åº“`ã€‚

    .. image:: media_mega2560/image183.png

ç°åœ¨ï¼Œå¦‚æœä½ ä½¿ç”¨ä¸€å¼ çº¸é è¿‘æˆ–è¿œç¦»ä¼ æ„Ÿå™¨ã€‚ä½ ä¼šçœ‹åˆ° LCD1602 ä¸Šæ˜¾ç¤ºçš„å€¼å‘ç”Ÿå˜åŒ–ï¼Œè¿™è¡¨ç¤ºçº¸å¼ ä¸è¶…å£°æ³¢ä¼ æ„Ÿå™¨ä¹‹é—´çš„è·ç¦»ã€‚

.. image:: media_mega2560/image184.jpeg

ä»£ç 
-----------------------

.. raw:: html

    <iframe src=https://create.arduino.cc/editor/sunfounder01/6bd4821b-3e3d-4ad2-8fb1-b72965ebea57/preview?embed style="height:510px;width:100%;margin:10px 0" frameborder=0></iframe>

ä»£ç åˆ†æ
----------------

**åˆå§‹åŒ–è¶…å£°æ³¢å’ŒLCD1602**

.. code-block:: Arduino

    #include <LiquidCrystal.h>
    #include <NewPing.h>

    LiquidCrystal lcd(4, 6, 10, 11, 12, 13);//lcd(RS,E,D4,D5,D6,D7)

    #define TRIGGER_PIN  2  //  trig pin on the ultrasonic sensor attach to pin2 .
    #define ECHO_PIN     3  //  echo pin on the ultrasonic sensor attach to pin3.
    #define MAX_DISTANCE 400 // Maximum distance we want to ping for (in centimeters). Maximum sensor distance is rated at 400-500cm.

    NewPing sonar(TRIGGER_PIN, ECHO_PIN, MAX_DISTANCE); // NewPing setup of pins and maximum distance.


åˆ›å»ºä¸€ä¸ª ``NewPing`` å˜é‡ ``sonar``ã€‚NewPingçš„åŸºæœ¬æ ¼å¼ä¸ºï¼š ``NewPing(uint8_t trigger_pin, uint8_t echo_pin, int max_cm_distance)`` ã€‚è¿™é‡Œuint è¡¨ç¤ºæ— ç¬¦å·æ•´æ•°ï¼Œ8 è¡¨ç¤º 8 ä½ã€‚æ‰€ä»¥è¿™é‡Œ uint8 æ ¼å¼çš„å€¼æ„å‘³ç€ä¸€ä¸ª unsigned-char ç±»å‹çš„å€¼ã€‚

**å°†æ—¶é—´è½¬æ¢æˆè·ç¦»**

.. code-block:: Arduino

    unsigned int uS = sonar.ping(); // Send ping, get ping time in
    microseconds (uS).

``ping()`` ç”¨æ¥è®¡ç®—ä»è„‰å†²å‘é€åˆ°æ¥æ”¶çš„æ—¶é—´ã€‚å®šä¹‰ä¸€ä¸ªå˜é‡ ``Us`` æ¥å­˜å‚¨æ¥æ”¶çš„æ—¶é—´ï¼Œå•ä½åº”è¯¥æ˜¯å¾®ç§’ï¼ˆusï¼‰ã€‚

.. code-block:: Arduino

    int distance = uS / US_ROUNDTRIP_CM;

``uS / US_ROUNDTRIP_CM `` æ˜¯å°† ``ping()`` å‘é€å’Œæ¥æ”¶ä¹‹é—´çš„æ—¶é—´è½¬æ¢ä¸ºè·ç¦»çš„å…¬å¼ï¼Œå•ä½æ˜¯å˜ç±³ã€‚

**åœ¨LCD1602ä¸Šæ˜¾ç¤ºè·ç¦»**

.. code-block:: Arduino

    lcd.setCursor(0, 0);//Place the cursor at Line 1, Column 1. From here the characters are to be displayed
    lcd.print("Distance:");////Print Distance: on the LCD
    lcd.setCursor(0, 1);//Set the cursor at Line 1, Column 0
    lcd.print("             ");//Here is to leave some spaces after the characters so as to clear the previous characters that may still remain.
    lcd.setCursor(9, 1);//Set the cursor at Line 1, Column 9.
    lcd.print(distance);// print on the LCD the value of the distance converted from the time between ping sending and receiving. 
    lcd.setCursor(12, 1);//Set the cursor at Line 1, Column 12.
    lcd.print("cm");//print the unit "cm"